<source>
  @type tail
  path /fluentd/log/system.log
  pos_file /fluentd/pos/system.log.pos
  tag system_log
  <parse>
    @type regexp
    expression /^(?<timestamp>\w{3}\s+\d+\s+\d{2}:\d{2}:\d{2})\s+(?<host>\S+)\s+(?<process>\S+)\:\s(?<message>.*)$/
  </parse>
</source>

<match system_log>
  @type kafka2
  brokers kafka:9092
  default_topic system_logs
  <format>
    @type json
  </format>
</match>